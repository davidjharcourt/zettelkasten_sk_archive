(function(l){var f=window.AmazonUIPageJS||window.P,w=f._namespace||f.attributeErrors,b=w?w("DetailPageEbooksAssets",""):f;b.guardFatal?b.guardFatal(l)(b,window):b.execute(function(){l(b,window)})})(function(l,f,w){l.when("A","jQuery","ebooksImageBlockATF","cf").execute(function(b,a,c){function d(a){"undefined"!=typeof SitbReader&&SitbReader.LightboxActions.openReader(c.litbData.litbReftag)}function m(){var a=h.offset(),b=r.offset(),d=b.top-a.top,a=b.left-a.left,b=r.outerWidth(),e=r.outerHeight(),
m=h.outerHeight()-(h.outerHeight()-r.outerHeight())/2;v.css("top",d+z).css("left",a+b-v.width());n.css("position","absolute").css("top",d).css("left",a).width(b).height(e);r.css("position","absolute").css("top","0").css("left","0");g.height(m);(f.innerWidth||document.body.offsetWidth)<c.windowWidthThreshold&&k()}function k(){var a=f.innerWidth||document.body.offsetWidth;if(!(0>=a))if(a>c.windowWidthThreshold){var a=c.configWidths[1],g=a/c.holderRatio,b=c.frontImageWidth,h=c.frontImageHeight;p(a,g,
b,h)}else a<c.windowWidthThreshold&&(a=c.configWidths[0],g=a/c.holderRatio,c.frontImageAspectRatio>c.holderRatio?(b=a,h=b/c.frontImageAspectRatio):(h=g,b=h*c.frontImageAspectRatio),p(a,g,b,h))}function p(b,h,d,k){if(0<b&&0<h&&0<d&&0<k){C.length&&l.length&&(C.css("margin-left",b+c.centerColMargin).removeClass("centerColumn"),l.width(b));var e=h+c.containerMargin;t.width(b).height(e);r.width(d).height(k);n.width(d).height(k);g.height(h-(h-r.outerHeight())/2);b=(g.outerWidth()-r.outerWidth())/2;h=g.outerHeight()-
r.outerHeight();n.css("top",h).css("left",b);v.css("top",h+z).css("left",b+d-v.width());a(this).trigger("imageResize")}}var t=a("#ebooksImageBlock"),q=a("#ebooksImgBlkFront"),e=a("#ebooksImgBlockInlineVideo"),u=a("#ebooksImgBlockInlineVideoSrc");if(t.length){var h=t.find("#ebooks-img-wrapper"),g=t.find("#ebooksImageBlockContainer"),n=t.find("#ebooks-img-canvas"),r=n.find(".frontImage"),l=a("#leftCol"),C=a("#centerCol"),x=a("#ebooksImageBlockOuter"),v=x.find("#ebooksSitbLogo"),x=x.find("#ebooksSitbLogoImg"),
z=parseInt(t.css("margin-top"));m();n.addClass("image-2d");c&&c.litbData&&c.litbData.hasLitb&&c.litbData.litbReftag&&(x.removeClass("a-hidden"),x.click(d),n.click(d),n.addClass("clickableImage"));a(f).resize(k)}else throw Error("Element with id imageBlock is missing");b.on("a:image:load",function(a){e.length&&u.length&&c.hasCoverImageInlineVideo&&(q.hide(),e.show())});b.loadDynamicImage(q)});l.when("A","jQuery","imageThumbNails","ready").execute(function(b,a,c){function d(){0<e.scrollLeft()&&(z=e.scrollLeft(),
z>A?y=e.scrollLeft()-A:(y=0,setTimeout(function(){t.removeClass("enabled")},750)),k(),q.addClass("enabled"))}function m(){e.scrollLeft()+e.width()<v&&(w=v+x-(e.scrollLeft()+e.width()),w>A?y=e.scrollLeft()+A:(y=e.scrollLeft()+w,setTimeout(function(){q.removeClass("enabled")},750)),k(),t.addClass("enabled"))}function k(){e.animate({scrollLeft:y},750)}function p(){var a=f.navigator.userAgent,c=a.indexOf("MSIE "),b=a.indexOf("Trident/"),a=a.indexOf("Edge/");return 0<c||0<b||0<a}var t=a("#thumbs-left"),
q=a("#thumbs-right"),e=a(".thumbnail-container .a-carousel-viewport");b=a(".thumbnail-container .a-carousel");var u=a("#thumbImage-1"),h=a("#thumbImage-6"),g=a("#ebooksImageBlock"),n=a("#ebooksImgBlkFront"),r=a("#ebooksImgBlockInlineVideo"),l=a("#ebooksImgBlockInlineVideoSrc"),C=a(".thumbnail-container .a-carousel .a-carousel-card img"),x=6*c.thumbInlineVideos.length,v=h.width()*c.thumbInlineVideos.length;if(b.length&&e.length&&n.length&&r.length&&l.length&&g.length){var z=0,w=0,A=e.width(),y=0,B=
g.find("#ebooks-img-canvas"),D=g.find("#ebooks-img-wrapper");B.css("left","0");B.width(D.width());a(f).resize(function(){B.css("left","0");B.width(D.width())});u.addClass("selected-thumb");e.bind("mouseenter",function(){t.show(500);q.show(500);0<e.scrollLeft()&&t.addClass("enabled");e.scrollLeft()+e.width()<v&&q.addClass("enabled")});C.mouseover(function(b){var h=a(".thumbnail-container .a-carousel-card .selected-thumb"),g=a("#"+b.target.id);if(h.length&&h[0]===b.target)return!1;b=b.target.parentElement.attributes.getNamedItem("aria-posinset");
null!==b&&(b=parseInt(b.value),h.removeClass("selected-thumb"),g.addClass("selected-thumb"),n.attr("src",c.thumbImages[b-1]),r.attr("poster",c.thumbImages[b-1]),r.hide(),n.show(),l.attr("src",c.thumbInlineVideos[b-1]),r.load(),p()?setTimeout(function(){n.hide();r.show()},1E3):(n.hide(),r.show()))});t.bind("click",function(a){a.preventDefault();d()});q.bind("click",function(a){a.preventDefault();m()})}});l.when("A","jQuery","Airy","ebookVideoReady","ready").execute(function(b,a,c,d){function m(){q=
c.embed({bindings:{play:function(){d.openVideoInFullScreen&&q.enterFullScreen()}},desiredMode:"html",parentId:"ebook-airy-player-container",streamingUrls:[d.videoSource],swfUrl:d.swfUrl})}function k(){try{q.detach()}catch(a){throw Error(a.message);}q={};setTimeout(function(){m()},100)}function p(b){a.ajax("/gp/digital/fiona/ajax/reftagCall.html/ref\x3d"+(d.refTag+b),{method:"get",cache:!1});document.body.style.overflow="hidden";e.removeClass("ebook-video-overlay-hidden");q.play();setTimeout(function(){e.addClass("ebook-overlay-on");
u.addClass("ebook-overlay-on");h.addClass("ebook-overlay-on")},10)}function t(){try{q.pause()}catch(a){throw Error(a.message);}document.body.style.overflow="visible";e.removeClass("ebook-overlay-on");u.removeClass("ebook-overlay-on");h.removeClass("ebook-overlay-on");setTimeout(function(){e.addClass("ebook-video-overlay-hidden");k()},150)}var q,e=a("#ebook-video-overlay"),u=a("#ebook-lightbox"),h=a("#ebook-lightbox-video-close");b=a("#ebooksImageBlock");var g=a("#ebooks-main-image-container");if(!e.length||
"undefined"===typeof d)throw Error("Video player not found");m();a("#ebook-video-play").bind("click",function(a){a.preventDefault();p("_text")});h.bind("click",function(a){a.preventDefault();t()});a("#ebook-lightbox-dark").bind("click",function(){t()});if(b.length){var n=/Edge\/|Trident\/|MSIE /.test(f.navigator.userAgent);d.showVideoPreviewTextOnCoverImageHover&&g.length&&!n&&(g.addClass("ebookPreviewVideo"),g=document.createElement("div"),g.innerHTML=d.watchVideoText,g.setAttribute("class","ebookPreviewVideoText"),
document.getElementById("ebooks-main-image-container").appendChild(g),b.bind("click",function(a){a.preventDefault();p("_img")}))}});l.when("A","jQuery","ebooksBackgroundImageLoad","cf").execute(function(b,a,c){function d(a,b){var c=document.getElementById(a);if("undefined"!==typeof c&&null!==c){var d=c.contentDocument;"undefined"!==typeof d&&null!==d&&(c=d.body,d=d.getElementById(b),"undefined"!==typeof c&&"undefined"!=typeof d&&null!==c&&null!==d&&(c.style.background="transparent",d.allowTransparency=
"true"))}}var m=a("#a-page");m.css("background-size","100%");var k=a(".a-expander-partial-collapse-header"),p=a("#dbs-nav-section");c.displayBackgroundImage?(m.css("background-repeat","no-repeat"),d("bookDesc_iframe","iframeContent"),a(function(){d("product-description-iframe","pdIframeContent");m.css("background-image","url("+c.backgroundImageUrl+")")})):c.displayBackgroundPattern&&(m.css("background-repeat","repeat-y"),m.css("background-image","url("+c.backgroundImageUrl+")"),k.length&&(k.css("background-image",
"url("+c.backgroundImageUrl+")"),k.css("background-size",f.innerWidth+"px"),b=a("#ebooksProductDescriptionExpander"),b=(f.innerWidth-b.width())/2,k.css("background-position","-"+b+"px"),k.css("background-repeat","no-repeat")),p.length&&(p.css("background-image","url("+c.backgroundImageUrl+")"),p.css("background-size","100%")));a(f).resize(function(){c.displayBackgroundImage&&(1E3>f.innerWidth?m.css("background-size","1000px"):m.css("background-size","100%"));k.length&&k.css("background-size",f.innerWidth+
"px");p.length&&k.css("background-size",f.innerWidth+"px")})});l.when("A","jQuery","atf").execute(function(b,a){var c=a("#udpKcpAppAdImage"),d=a("#udpComiXologyAd");c.length&&b.loadHiResImage(c);d.length&&b.loadHiResImage(d)});l.when("A","jQuery","cf").execute(function(b,a){a('a[href^\x3d"#kindle-illustrated-learn-more"]').click(function(c){c.preventDefault();var b=this.hash;c=a(b).offset().top-100;a("html, body").stop().animate({scrollTop:c},1200,"swing",function(){f.location.hash=b})})});l.when("A",
"jQuery","contentQualityWidgetReady").execute(function(b,a,c){a.ajax("/gp/digital/fiona/ajax/reftagCall.html/ref\x3d"+c.onloadReftag,{method:"get",cache:!1});b.on("a:popover:show:kcqPopverPreload",function(){a.ajax("/gp/digital/fiona/ajax/reftagCall.html/ref\x3d"+c.hoverOverReftag,{method:"get",cache:!1})})});l.when("A","jQuery","ready","atf").execute(function(b,a){var c=b.state("goodreadsFacebubblesState");void 0!==c&&b.ajax("/kindle-dbs/external-service/goodreads-facebubbles",{method:"get",params:{profileId:c.goodreadsProfileId,
asin:c.asin},success:function(b){a("#goodreads-facebubble").append(b)}})});l.when("A","jQuery","atf","a-carousel-framework").execute(function(b,a,c,d){function m(b){a.ajax("/kindle-dbs/reftag?ref_\x3d"+b,{method:"get",data:p})}function k(b,c){var d=a(f).scrollTop(),k=a(f).scrollLeft(),h=k+a(f).width(),g=d+a(f).height(),n=a(c).offset();n.right=n.left+a(c).outerWidth();n.bottom=n.top+a(c).outerHeight();return!(n.right<k||n.left>h||n.top>g||n.bottom<d)}var p={pageType:"featureAwareness",subPageType:"featureAwarenessShoveler",
hitType:"dataOnly"};d.onInit("faw-carousel",function(c){function d(b,g){var n=a("\x3cimg\x3e");n.load(function(){k(void 0,g)&&a(g).attr("aria-posinset")==c.getAttr("firstVisibleItem")&&(a(g).find(".fawPrimaryImage").attr("src",a(this).attr("src")),a(g).addClass("loadedCard"),m(a(g).data("gifTag")))});n.attr("src",a(g).data("gifUrl"))}function e(b,g){k(void 0,g)&&a(g).attr("aria-posinset")==c.getAttr("firstVisibleItem")||(a(g).find(".fawPrimaryImage").attr("src",a(g).data("imgUrl")),a(g).removeClass("loadedCard"))}
function p(){setTimeout(function(){a(".fawCarouselCard").eq(c.getAttr("firstVisibleItem")-1).filter(k).not(".loadedCard").each(d);a(".fawCarouselCard").filter(".loadedCard").each(e)},300)}b.on.afterLoad(p);b.on.scroll(p);b.on("a:carousel:faw-carousel:change:firstVisibleItem",function(b){b=c.getAttr("totalPages");var g=a("#fawCarousel").width(),d=a(".fawCarouselCard").outerWidth(),g=Math.trunc(g/d),d=a(".faw-carousel-left-button"),k=a(".faw-carousel-right-button");"1"==c.getAttr("firstVisibleItem")?
(d.addClass("aok-hidden"),k.removeClass("aok-hidden")):b-(c.getAttr("firstVisibleItem")-1)==g?(d.removeClass("aok-hidden"),k.addClass("aok-hidden")):(d.removeClass("aok-hidden"),k.removeClass("aok-hidden"));p()});a(".fawVideoTrigger").bind("click",function(b){b.preventDefault();b=a(this).parent(".fawCarouselCard").attr("aria-posinset")-1;a(".faw-modal").css("display","inline");a(".faw-modal").css("visibility","visible");var c=playList[b];a("#fawIframe").attr("src",c);a("#fawIframe").attr("index",
b);var c=playList.length,d=b+1+" of "+c;a(".videoIndex").text(d);0==b?(a(".previous-video").css("visibility","hidden"),a(".next-video").css("visibility","visible")):b==c-1?(a(".next-video").css("visibility","hidden"),a(".previous-video").css("visibility","visible")):(a(".previous-video").css("visibility","visible"),a(".next-video").css("visibility","visible"));m(a(this).data("refTag"));return!1});a(".previous-video").bind("click",function(b){b=a("#fawIframe").attr("index");1==b?a(".previous-video").css("visibility",
"hidden"):a(".previous-video").css("visibility","visible");a(".next-video").css("visibility","visible");var c=b+" of "+playList.length;a(".videoIndex").text(c);b=--b;c=playList[b];a("#fawIframe").attr("src",c);a("#fawIframe").attr("index",b);m(refTagList[b])});a(".next-video").bind("click",function(b){var c=a("#fawIframe").attr("index");c==playList.length-1-1?(a(".previous-video").css("visibility","visible"),a(".next-video").css("visibility","hidden")):(a(".previous-video").css("visibility","visible"),
a(".next-video").css("visibility","visible"));b=++c;var d=playList[b];a("#fawIframe").attr("src",d);a("#fawIframe").attr("index",b);c=c+1+" of "+playList.length;a(".videoIndex").text(c);m(refTagList[b])});a(".close-video").bind("click",function(b){a("#fawModal").css("display","none")});a(".fawCarouselCard").bind("mouseenter",function(b){b.preventDefault();b=a(".loadedCard").parent(".fawCarouselCard");a(".loadedCard").attr("src",a(b).attr("data-img-url"));a(".loadedCard").removeClass("loadedCard");
b=a(this).find(".fawPrimaryImage");a(b).attr("src",a(this).attr("data-gif-url"));a(b).addClass("loadedCard")})})});l.when("a-carousel-framework","a-carousel-display-fawdisplay").execute(function(b,a){b.registerStrategy("display","fawDisplay",a)});l.when("A","jQuery","a-carousel-constants").register("a-carousel-display-fawdisplay",function(b,a,c){var d={};d[c.PAGE_SIZE]=1;var m,k;return{initAttrs:d,init:function(a){a.dom.$carousel.children("li").css("visibility","visible");m=a.getAttr(c.SET_SIZE);
k=260*m;a.dom.$carousel.width(k);a.updateDimensionsCache({carousel:{width:k},items:b.map(b.range(m),function(){return{width:250,outerWidth:260}})});this.repaint(a)},repaint:function(b){var d=b.getDimensions().viewport.width;b.setAttr(c.PEEK_WIDTH,(d-250)/2,!1);a(".faw-carousel-right-button").css("left",d-15+"px");k<=d?a(".faw-carousel-buttons").css("display","none"):a(".faw-carousel-buttons").css("display","inline")},resize:function(a,b){b.viewport&&void 0!==b.viewport.width&&this.repaint(a)}}});
l.when("A","ready").execute(function(b){var a=!1,c=b.state("deliverToState");if(c){var d=c.deliverToDropdownName;c.asinRequiresSecureDelivery&&l.when("A","a-alert","a-dropdown").execute(function(a,b,l){var f=b(".ebookBuyboxDrmDeliverToAlert"),q=c.customerDeviceMap,e=!1,u=function(a){var b=a.message;a.actionLinkHref&&a.actionLinkText&&(b=b+' \x3ca class\x3d"a-link-normal" href\x3d"'+a.actionLinkHref+'"\x3e'+a.actionLinkText+"\x3c/a\x3e");f.html(b).show();ue&&ue.count&&!e&&ue.count("deliverToDRMWarningDisplayCount",
1);e=!0};(b=q[c.dropdownDefaultOption].warningMessage)&&u(b);a.on(d,function(b){var c=q[b.value].warningMessage;c?u(c):f.hide();a.$(".ebookBuyboxDeliverToDropdown").each(function(a,c){l.getSelect(c).setValue(b.value)})})});b.on(d,function(b){ue&&ue.count&&!a&&(ue.count("deliverToSelectionCount",1),c.isTextbook&&ue.count("deliverToSelectionForEtextbookCount",1),a=!0)})}});"use strict";l.when("A","jQuery","ready").register("accordionInstrumentation",function(b,a){var c=f.ue,d,m=function(){this.accordionType=
"";this.accordionCounterId="ebookAccordion";this.setAccordionCounterId=function(a){this.accordionCounterId=a;this.accordionType||(this.accordionType=a)};this.addRowsToCounterId=function(a){a=a.replace(/([^\[\],\s]+)/g,'"$\x26"').toLowerCase();if(a=JSON.parse(a)){for(row in a)this.accordionCounterId+="-"+a[row];c&&c.count&&c.count(this.accordionCounterId,0)}};this.accordionSwitch=function(){c&&c.count&&c.count(this.accordionCounterId,1+(c.count(this.accordionCounterId)||0))};this.buttonClick=function(a){var b=
"ebookUnifiedBuybox";this.accordionType&&(b=this.accordionType);c&&c.count&&c.count(b+"-"+a,c.count(this.accordionCounterId)||0)}};return{counter:function(){d||(d=new m);return d}}});l.when("A","nfcxMessageMetrics").execute(function(b,a){b.on("a:popover:hide:NfcxPopover",function(b){c("Nfcx:message:popup:close:"+a.nfcxWeblabTreatment);d()});b.on("a:popover:show:NfcxPopover",function(b){c("Nfcx:message:popup:open:"+a.nfcxWeblabTreatment);d()});var c=function(a){f.ue&&ue.tag&&(ue.tag(a,"nfcxAlert"),
ue.count(a,1))},d=function(){f.ue&&uex("ld","nfcxAlert")}});l.when("A").execute(function(b){b.on("a:popover:hide:oneClickInfoPopover",function(b){a("oneClickInfoPopover:popup:close");c()});b.on("a:popover:show:oneClickInfoPopover",function(b){a("oneClickInfoPopover:popup:open");c()});var a=function(a){f.ue&&ue.tag&&(ue.tag(a,""),ue.count(a,1))},c=function(){f.ue&&uex("ld","oneClickInfoPopover")}});l.when("A","ready").execute(function(b){var a=b.state("deviceRestrictionPopoverState"),c=!1;if(a){var d=
a.metricName;b.on("a:popover:beforeShow:"+a.deviceRestrictionPopoverName,function(a){ue&&ue.count&&!c&&(ue.count(d,(ue.count(d)||0)+1),c=!0)})}});l.when("A","ready").execute(function(b){var a=b.state("deviceRestrictionBottomSheetState"),c=!1;if(a){var d=a.metricName;b.on("a:sheet:afterShow:"+a.deviceRestrictionBottomSheetName,function(a){ue&&ue.count&&!c&&(ue.count(d,(ue.count(d)||0)+1),c=!0)})}});l.when("A","jQuery").execute(function(b,a){a(".pointsAwarePriceBlock .loyaltyPointsToolTip").removeAttr("title")});
(function(b){b(f.P._namespace("ebooksAddToCart"))})(function(b){b.when("A","jQuery","accordionInstrumentation","ready").execute(function(a,b,d){a.declarative("add-to-ebooks-cart","click",function(a){var b=jQuery("#cart-button-container"),c=jQuery("#view-cart-button-container"),d=jQuery("#add-to-ebooks-cart-spinner"),l=jQuery("#add-to-cart-message"),e={asin:a.data.asin,csrf:a.data.csrf,action:"add"},f=jQuery("#deliverTo").find(":selected").val();void 0!==f&&/^[0-9a-zA-Z]+$/.test(f)&&(e.device={encryptedDeviceAccountId:f});
var h="#cart-error-message";b.hide();d.removeClass("aok-hidden");l.find(h).attr("style","display:none;");jQuery.ajax({url:a.data.url,type:"POST",dataType:"json",data:JSON.stringify(e),contentType:"application/json",headers:{Accept:"application/json"},success:function(a){jQuery("html, body").animate({scrollTop:0},"slow");d.addClass("aok-hidden");if(a.resources&&a.resources.detailedStatus){var e=b.find("button");a=a.resources;var f=a.detailedStatus,m=a.navCartCount;void 0!==m&&NaN!==Number(m)&&navbar.setCartCount(m);
switch(f){case "ok":case "buyablePriceUnavailable":case "priceIncrease":h="#cart-success-message";c.removeClass("aok-hidden");break;case "duplicateAddition":h="#cart-violation-message";c.removeClass("aok-hidden");break;case "alreadyOwned":h="#cart-violation-message";b.show();b.removeClass("a-button-focus");b.addClass("a-button-disabled");e.attr("disabled",!0);break;case "limitExceeded":case "unavailable":h="#cart-warning-message",b.show()}e=l.find(h);f=a.displayMessage.displayString;e.find(".cart-message").text(f);
if("#cart-success-message"===h){f=a.referenceData.bundle.summary;a=f.totalItemCount;var f=f.totalPriceWithTaxAndDiscount.amount,m=e.find("#cart-summary-item-count"),u=a+" "+m.data("item-label");1<a&&(u=a+" "+m.data("items-label"));m.text("("+u+"): ");e.find("#cart-summary-total-amount").text(f)}e.attr("style","display:block;")}else b.show(),l.find(h).attr("style","display:block;")},error:function(){jQuery("html, body").animate({scrollTop:0},"slow");d.addClass("aok-hidden");b.show();l.find(h).attr("style",
"display:block;")}})});a.declarative("checkout-ebooks-cart","click",function(a){jQuery('\x3cform method\x3d"POST" action\x3d"'+a.data.ebooksCartCheckoutUrl+'"\x3e\x3c/form\x3e').appendTo("body").submit()})})})});